# 塔防游戏设计文档 (Tower Defense Game Design Document)

## 项目概述
简单的2D塔防游戏，采用极简主义扁平化设计风格。

---

## 一、美术风格

### 核心风格
- **极简主义 (Minimalist)**: 界面干净，无不必要装饰
- **扁平化设计 (Flat Design)**: 纯色块组成，无复杂纹理
- **2.5D视角**: 俯视角配合长阴影营造立体感

### 色彩方案
```
背景：      #1A1A1A (深木炭灰)
主场景：    #00CED1 (饱和青色)
敌人：      #FF1493 (热粉色) + #9B30FF (亮紫色)
Boss：      #FF4500 (橙红色)
货币/资源： #FFD700 (金黄色)
UI/炮塔：   #FFFFFF (白色) + #808080 (灰色)
基地：      #32CD32 (翠绿色)
危险：      #FF8C00 (橙色)
路径：      #2F4F4F (深石板灰)
```

### 视觉特征
- **长阴影**: 所有物体投射45度长阴影（向右下方，rgba(0,0,0,0.3)）
- **辉光效果**: 敌人、货币、炮弹有霓虹辉光
- **粒子效果**:
  - 射击：白色曳光弹线条
  - 命中：白色火花
  - 死亡：粒子爆炸

---

## 二、游戏机制

### 1. 关卡系统
- **关卡数量**: 10关
- **难度**: 单一难度（通过关卡递进提升难度）
- **地图类型**: 固定路径（可能包括U形、S形、环形等复杂形状）
- **兵线**: 单一兵线，不支持多路径

### 2. 核心建筑

#### 基地（终点建筑）
- **初始血量**: 20 HP
- **失败条件**: 血量降至0
- **UI显示**: 实时显示基地血量
- **位置**: 路径终点

#### 防御塔槽位
- **数量**: 关卡设计决定（每关不同）
- **限制**: 每个槽位只能建造1座塔
- **操作**: 可拆除并重建（无返还金币）

---

## 三、敌军系统

### 敌军类型

| 类型 | HP | 速度 | 金币奖励 | 外观 |
|------|-----|------|----------|------|
| 普通怪 (Normal) | 50 | 60 | 10金 | 粉色圆形 |
| 精英怪 (Elite) | 150 | 40 | 50金 | 紫色六边形 |
| Boss | 1000 | 30 | 200金 | 橙红色大型圆形 |

### 波次系统

#### 结构
- 每关有**多波进攻**（关卡设计决定）
- 每波包含**多批怪物**
- 每批怪物以**固定时间间隔**生成

#### 示例配置
```
第1波: 1批，每批2个普通怪
第2波: 2批，每批10个普通怪，间隔3秒
第3波: 3批，每批15个普通怪+2个精英怪，间隔3秒
...
最后一波: 包含1个Boss
```

#### 备战时间
- 波次间隔: **30秒**
- 玩家可提前开始下一波（无奖励）

### Boss机制
- **出现时机**: 最后一波
- **特点**: 血量极厚（1000 HP）
- **速度**: 较慢（30）
- **金币**: 200金

---

## 四、防御塔系统

### 防御塔类型

#### 1. 箭塔 (Arrow Tower)
- **类型**: 单体攻击
- **基础攻击力**: 20
- **攻击速度**: 1.0/秒
- **攻击范围**: 150像素
- **建造成本**: 100金（首座）

#### 2. 减速塔 (Slow Tower)
- **类型**: 范围减速
- **基础攻击力**: 5
- **减速效果**: 50%
- **攻击速度**: 0.5/秒
- **攻击范围**: 120像素
- **建造成本**: 150金（首座）

#### 3. 范围塔 (AoE Tower)
- **类型**: 范围伤害
- **基础攻击力**: 10（溅射50%）
- **攻击速度**: 0.8/秒
- **攻击范围**: 180像素
- **溅射范围**: 80像素
- **建造成本**: 200金（首座）

### 升级系统
- **最大等级**: 3级
- **升级成本**: 建造成本 × 1.5 × 等级
- **升级效果**:
  - 攻击力 +30%
  - 攻击速度 +20%
  - 攻击范围 +10%

### 成本递增机制
- **同一局内**，建造同种塔成本递增**20%**
- 示例：
  - 第1座箭塔：100金
  - 第2座箭塔：120金
  - 第3座箭塔：144金

### 目标选择
- **默认**: 攻击射程内**最近的敌人**
- **锁定**: 持续攻击直到目标死亡或脱离射程

---

## 五、经济系统

### 金币获取
- **初始金币**: 500金
- **击杀奖励**:
  - 普通怪: 10金
  - 精英怪: 50金
  - Boss: 200金
- **波次奖励**: 每波完成奖励50金

### 金币消耗
- **建造防御塔**: 100-200金（递增）
- **升级防御塔**: 建造成本 × 1.5 × 等级
- **拆除**: 无返还

---

## 六、UI/UX设计

### 游戏界面布局

#### 顶部信息栏
```
[金币: 500] [波次: 1/10] [基地血量: 20/20]
```

#### 底部控制栏
```
[箭塔 100金] [减速塔 150金] [范围塔 200金] | [开始波次] [暂停] [2x速度]
```

#### 侧边信息面板（可选）
- 当前选中塔的详细信息
- 升级按钮
- 拆除按钮

### 建造流程
1. 点击底部塔按钮 → 进入建造模式
2. 点击空闲槽位 → 建造塔
3. 扣除金币，塔立即生效

### 升级流程
1. 点击已建造的塔 → 显示详情面板
2. 点击升级按钮 → 扣除金币并升级

### 游戏控制
- **暂停**: 暂停游戏（可建造/升级）
- **倍速**: 1x / 2x 切换
- **开始波次**: 手动开始下一波

---

## 七、关卡设计规范

### 关卡配置文件结构
```typescript
interface LevelConfig {
  id: number;
  name: string;
  path: PathPoint[];         // 路径坐标
  slots: SlotPosition[];     // 塔槽位坐标
  waves: WaveConfig[];       // 波次配置
  baseHP: number;            // 基地初始血量
  startGold: number;         // 初始金币
}

interface WaveConfig {
  batches: BatchConfig[];    // 批次配置
}

interface BatchConfig {
  enemyType: 'normal' | 'elite' | 'boss';
  count: number;             // 怪物数量
  delay: number;             // 距离上批的延迟（秒）
}
```

### 关卡难度曲线
```
关卡1: 教学关（2波，只有普通怪）
关卡2-3: 简单（3-4波，少量精英怪）
关卡4-6: 中等（5-6波，较多精英怪）
关卡7-9: 困难（7-8波，大量精英怪）
关卡10: Boss关（10波，最后一波有Boss）
```

---

## 八、技术实现

### 技术栈
```
前端框架:    React 18 + TypeScript
构建工具:    Vite
游戏引擎:    Phaser 3
状态管理:    Zustand
样式:        CSS Modules + Tailwind CSS
动画:        Phaser Tweens + GSAP
```

### 项目结构
```
src/
├── components/          # React UI组件
│   ├── GameCanvas.tsx   # Phaser游戏容器
│   ├── HUD.tsx          # 顶部信息栏
│   ├── ControlPanel.tsx # 底部控制栏
│   └── TowerInfo.tsx    # 塔详情面板
├── game/                # Phaser游戏逻辑
│   ├── scenes/
│   │   ├── GameScene.ts # 主游戏场景
│   │   └── UIScene.ts   # UI场景
│   ├── entities/
│   │   ├── Enemy.ts     # 敌人类
│   │   ├── Tower.ts     # 防御塔基类
│   │   └── Base.ts      # 基地类
│   ├── managers/
│   │   ├── WaveManager.ts      # 波次管理
│   │   ├── EconomyManager.ts   # 经济管理
│   │   └── PathManager.ts      # 路径管理
│   └── config/
│       └── levels.ts    # 关卡配置
├── store/               # Zustand状态管理
│   └── gameStore.ts
├── types/               # TypeScript类型定义
│   └── game.ts
└── utils/               # 工具函数
    └── pathfinding.ts
```

---

## 九、开发里程碑

### Phase 1: 基础架构（第1-2天）
- [x] 项目初始化
- [ ] 基础画布渲染
- [ ] 路径系统
- [ ] 槽位系统

### Phase 2: 核心玩法（第3-5天）
- [ ] 敌人生成与移动
- [ ] 防御塔建造与升级
- [ ] 攻击与伤害系统
- [ ] 经济系统

### Phase 3: 波次管理（第6-7天）
- [ ] 波次管理器
- [ ] 基地血量系统
- [ ] 胜利/失败条件

### Phase 4: 关卡设计（第8-9天）
- [ ] 创建10个关卡配置
- [ ] 关卡选择界面

### Phase 5: 美化与优化（第10天）
- [ ] 美术风格实现
- [ ] 粒子效果
- [ ] 音效（可选）
- [ ] 性能优化

---

## 十、后续扩展（可选）

### 潜在功能
- [ ] 技能树系统（永久升级）
- [ ] 关卡星级评价
- [ ] 成就系统
- [ ] 更多敌人类型（飞行、隐身等）
- [ ] 更多防御塔类型
- [ ] 多兵线关卡
- [ ] 无尽模式

---

**版本**: v1.0
**创建日期**: 2025-10-22
**最后更新**: 2025-10-22
